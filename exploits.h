#ifndef _EXPLOITS_H_
#define _EXPLOITS_H_

#include "utils.h" 

#define EXPLOITS_NUMBER 5
#define EXPLOIT_NAME_LENGTH 128

// main structure in place of current_exploit
struct Xploit
{
    struct exploit *currentExploit;
    struct payload *currentPayload;
};

struct exploitParam {
    char name[EXPLOIT_NAME_LENGTH];
    enum PARAM_REQUIREMENT required;
    enum PARAM_TYPE type;
    unsigned int value;
    char *strValue;
    unsigned int strValueLen;
};

struct exploit {
	unsigned int id;
	char name[EXPLOIT_NAME_LENGTH];
	int (*func)(struct Xploit *xp, unsigned char *, unsigned int);
    struct exploitParam *params;
	unsigned int paramsNum;
	void (*help)(void);
    struct details *det;
};

struct Xploit *xploitUseExploit(char *name);
void xploitReleaseExploit(struct Xploit *xp);
int xploitGetExploitID(char *name);
void xploitShowExploits();
void xploitShowExploitHelp(char *name);
int xploitRunExploit(struct Xploit *xp);
int xploitSetExploitOpt(struct Xploit *xp, char *paramName, void *newValue);

int exploitsInit();

extern struct exploit dummy;
extern struct exploit vmwareMountSuid;
extern struct exploit setuidNmap;
extern struct exploit execAwstats;
extern struct exploit fdiscWebmin;

#endif
