#include "../exploits.h"
#include <stdio.h>

int dummy_exp(struct Xploit *xp, unsigned char *rawPayload, unsigned int rawPayloadLen)
{
    unsigned char *payload;
    unsigned int payload_len;
    void (*fptr)();

    /*
    // This will only work when NX is disabled (add to gcc option: -z execstack)
    payload = current_payload.data;
    payload_len = current_payload.len;
    fptr = (void(*)())payload;
    fptr();

    payload = current_payload.data;
    payload_len = current_payload.len;
    create_x86_elf("dummy-ng", payload, payload_len);
    */

    payload = rawPayload;
    payload_len = rawPayloadLen;
    create_x86_elf("dummy-ng", payload, payload_len);
    
    return 0;
}

struct exploit dummy = {
    0,
    "dummy",
    dummy_exp,
    NULL,
    0,
    NULL, 
    NULL
};
